### **Hospital Management System (HMS) Project: A SQL Analysis ⚕️**

This project is a deep dive into SQL, where I tackled

**16 analytical questions** using a fictional Hospital Management System dataset1. It was a fantastic opportunity to apply a wide range of SQL techniques, from basic joins to advanced window functions, to solve real-world healthcare administration problems.

---

### **Table of Contents**

\- \[Project Overview\](\#project-overview)  
\- \[Dataset\](\#dataset)  
\- \[Tools Used\](\#tools-used)  
\- \[Setup\](\#setup)  
\- \[Sample Analysis & Queries\](\#sample-analysis--queries)  
\- \[Key SQL Concepts Covered\](\#key-sql-concepts-covered)


---

### **Project Overview**

The main goal was to practice and showcase my SQL skills by analyzing patient demographics, appointment trends, doctor performance, and hospital revenue. The project involves loading raw CSV data into a PostgreSQL database and then running a series of queries to extract meaningful insights.

---

### **Dataset**

The dataset consists of five CSV files that mimic a real Hospital Management System's database2:

* **patients.csv**: Contains information about each patient.  
* **doctors.csv**: Contains details for each doctor, including specialization and years of experience.  
* **appointments.csv**: The transactional table linking patients to doctors and treatments.  
* **treatments.csv**: Contains details about the treatments provided.  
* **billing.csv**: Contains billing information, including payment method and status.

---

### **Tools Used**

* **Database**: PostgreSQL  
* **Language**: Python (for data loading)  
* **Libraries**: pandas, SQLAlchemy

---

### **Setup**

To get this project running locally:

1. Make sure you have Python and PostgreSQL installed.  
2. Install the required Python libraries: pip install pandas SQLAlchemy.  
3. Create a new database in PostgreSQL.  
4. Update the connection details (username, password, database name) in the load\_csv\_files.py script.  
5. Update the base path in the load\_csv\_files.py script to the location where your CSV files are stored.  
6. Run the script from your terminal: python load\_csv\_files.py. This will create the necessary tables and load all the data from the CSV files.

---

### **Sample Analysis & Queries**

The

HMS project FOR SQL.sql file contains the solutions to all 16 questions3. Here are a few highlights:

#### **1\. Calculating the Average Days Between Patient Visits**

* **Business Question**: What is the average number of days between visits for each patient? 4  
* **Approach**: This complex, multi-step analysis first required calculating the time gap between each patient's consecutive visits using the LAG() window function. Then, I averaged these gaps to find their typical visit frequency. This insight is vital for understanding patient visit patterns.

SQL

\-- Query to find the average days between visits for each patient  
WITH T1 AS(SELECT patient\_id, appointment\_date,  
            LAG(appointment\_date, 1) OVER(PARTITION BY patient\_id ORDER BY appointment\_date) AS previous\_date  
            FROM appointments  
            WHERE status \= 'Completed'),

T2 AS(SELECT patient\_id,  
        appointment\_date \- previous\_date AS days\_between\_visits  
        FROM T1  
        WHERE previous\_date IS NOT NULL)

SELECT CONCAT(P.first\_name,' ',P.last\_name) AS patient\_name,  
FLOOR(AVG(T.days\_between\_visits)) AS avg\_days\_between\_visits  
FROM T2 AS T  
JOIN patients AS P ON  
P.patient\_id \= T.patient\_id  
GROUP BY P.patient\_id, patient\_name  
ORDER BY 2 DESC

#### **2\. Identifying Top Revenue-Generating Doctors in Each Hospital Branch**

* **Business Question**: Who are the top revenue-generating doctors in each hospital branch? 5  
* **Approach**: This required a multi-step process. First, I aggregated the total revenue generated by each doctor from paid treatments. Then, I used the DENSE\_RANK() window function, partitioned by hospital branch, to rank the doctors based on their revenue. This is key for spotting top performers and understanding which branches are most profitable.

SQL

\-- Query to find top revenue-generating doctors in each branch  
WITH T1 AS(SELECT CONCAT(D.first\_name,' ',D.last\_name) AS doc\_full\_name,  
            D.doctor\_id,  
            D.hospital\_branch,  
            SUM(B.amount) AS total\_revenue  
            FROM doctors AS D  
            INNER JOIN appointments AS A ON  
            A.doctor\_id \= D.doctor\_id  
            INNER JOIN treatments AS T ON  
            A.appointment\_id \= T.appointment\_id  
            INNER JOIN billing AS B ON  
            T.treatment\_id \= B.treatment\_id  
            WHERE B.payment\_status \= 'Paid'  
            GROUP BY 1, 2, 3)

SELECT hospital\_branch, doc\_full\_name, total\_revenue,  
DENSE\_RANK() OVER(PARTITION BY hospital\_branch ORDER BY total\_revenue DESC) as RANK  
FROM T1  
ORDER BY 1

---

### **Key SQL Concepts Covered**

This project provided hands-on experience with a wide array of SQL features, including:

* JOINS (Inner, Left, Self-Join)  
* Aggregate Functions (SUM, COUNT, AVG)  
* Grouping & Filtering (GROUP BY, HAVING)  
* Subqueries & Common Table Expressions (CTEs)  
* Conditional Logic (CASE statements)  
* Window Functions (ROW\_NUMBER, RANK, DENSE\_RANK, LAG, FIRST\_VALUE, LAST\_VALUE)  
* Date & String Manipulation  
* Calculating Running Totals, Rolling Averages, and Percent-of-Total  
* Data Modification (Using update statement)

Thanks for checking out my project\!

